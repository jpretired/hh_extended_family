<?php

use Fisharebest\Webtrees\I18N;
use Fisharebest\Webtrees\View;
use Fisharebest\Webtrees\Fact;
use Hartenthaler\Webtrees\Module\ExtendedFamily\ExtendedFamilySupport;
use Hartenthaler\Webtrees\Module\ExtendedFamily\Nephews_and_nieces;         // using const of this module

/*
 * (1) Special (not using named groups)
 * (1a) partners (grouped by partners/partners of partners)
 * (1b) partner chains (grouped by chains)
 * (1c) parents_in_law (grouped by partnerships)
 * (2) siblings_in_law, uncles_and_aunts_bm (grouped by reference person)
 * (2a)                                                                                 sister/brother of P
 * (2b)                                                                                 marriage/partnership with P
 * (3) nephews_and_nieces (grouped by reference person and reference person 2)
 * (3a)                                                                                 sister/brother of P
 * (3b)                                                                                 marriage/partnership with P
 * (4) children_in_law (grouped by reference person)
 * (4a)                                                                                 son/daughter/child
 * (4b)                                                                                 stepson/stepdaughter/stepchild
 * (5) great-grandparents, grandparents, parents, co-parents-in-law, uncles_and_aunts (grouped by families)
 * (5a)                                                                                 parents F of P
 * (5b)                                                                                 marriage/partnership P
 * (6) co-siblings-in-law (grouped by reference person)
 * (6a)                                                                                 parents F of P
 * (6b)                                                                                 partners of P
 * (7) siblings, cousins, children, grandchildren (grouped by childfamilies())          parents F
 */
 ?>
 
<div class="wt-tab-hh-extended-family py-4">
    <?php if ($extfam_obj->config->showFilterOptions &&
              ($extfam_obj->filters['all']->efp->allCount > 0)): ?>
        <table>
            <tr>
                <div class="btn-toolbar d-flex justify-content-between mb-2" role="toolbar">
                    <th>
                        <div class="btn-group btn-group-toggle btn-group-sm" data-toggle="buttons">
                            <label class="btn btn-outline-secondary" title="<?= I18N::translate("show only male persons") ?>">
                                <input class="hh-extended-filter-button" type="checkbox" autocomplete="off" data-filter-type="sex" data-filter-value="M">
                                <span class="wt-icon-sex wt-icon-sex-m"><i class="fas fa-mars fa-fw" aria-hidden="true"></i></span>
                            </label>
                            <label class="btn btn-outline-secondary" title="<?= I18N::translate("show only female persons") ?>">
                                <input class="hh-extended-filter-button" type="checkbox" autocomplete="off" data-filter-type="sex" data-filter-value="F">
                                <span class="wt-icon-sex wt-icon-sex-f"><i class="fas fa-venus fa-fw" aria-hidden="true"></i></span>
                            </label>
                            <label class="btn btn-outline-secondary" title="<?= I18N::translate("show only persons of unknown gender") ?>">
                                <input class="hh-extended-filter-button" type="checkbox" autocomplete="off" data-filter-type="sex" data-filter-value="U">
                                <span class="wt-icon-sex wt-icon-sex-u"><i class="fas fa-genderless fa-fw" aria-hidden="true"></i></span>
                            </label>
                        </div>
                    </th>
                    <th>&nbsp;</th>
                    <th>
                        <div class="btn-group btn-group-toggle btn-group-sm" data-toggle="buttons">
                            <label class="btn btn-outline-secondary" title="<?= I18N::translate("show only alive persons") ?>">
                                <input class="hh-extended-filter-button" type="checkbox" autocomplete="off" data-filter-type="alive" data-filter-value="Y">
                                <?= I18N::translate("alive") ?>
                            </label>
                            <label class="btn btn-outline-secondary" title="<?= I18N::translate("show only dead persons") ?>">
                                <input class="hh-extended-filter-button" type="checkbox" autocomplete="off" data-filter-type="alive" data-filter-value="N">
                                <?= I18N::translate("dead") ?>
                            </label>
                        </div>
                    </th>
                </div>
            </tr>
        </table>
    <?php endif ?>
    <?php foreach ($extfam_obj->filters as $filterOption => $filterObj) : ?>
        <div class="hh-extended-filter" data-filter-value="<?= $filterOption ?>">
            <?php if ($filterObj->efp->allCount > 0): ?>
                <?php foreach ($filterObj->efp as $propName => $propValue) : ?>
                    <?php if ($propName !== 'allCount' && $propName !== 'summaryMessageEmptyBlocks'): ?>
                        <?php if (($filterObj->efp->$propName->allCount > 0) or ($extfam_obj->config->showEmptyBlock == 0)): ?>
                            <h2><?= ExtendedFamilySupport::translateFamilyPart($filterObj->efp->$propName->partName) ?></h2>
                            <?php if ($extfam_obj->config->showParameters): ?>
                                <span class="hh_extended_family_parameter">
                                    <?php if ($extfam_obj->config->familyPartParameters[$propName]['generation'] > 0): ?>
                                        <?= I18N::translate('generation +%s', $extfam_obj->config->familyPartParameters[$propName]['generation']) ?>
                                    <?php elseif ($extfam_obj->config->familyPartParameters[$propName]['generation'] == 0): ?>
                                        <?= I18N::translate('same generation') ?>
                                    <?php else: ?>
                                        <?= I18N::translate('generation %s', $extfam_obj->config->familyPartParameters[$propName]['generation']) ?>
                                    <?php endif ?>
                                </span>
                                <span class="hh_extended_family_parameter">
                                    <?php if ($extfam_obj->config->familyPartParameters[$propName]['relationshipCoefficient'] > 0): ?>
                                        <?= I18N::translate('relationship coefficient: %.1f', 100*$extfam_obj->config->familyPartParameters[$propName]['relationshipCoefficient']) ?>%
                                        <?php if (isset($extfam_obj->config->familyPartParameters[$propName]['relationshipCoefficientComment'])): ?>
                                            (<?= I18N::translate($extfam_obj->config->familyPartParameters[$propName]['relationshipCoefficientComment']) ?>)
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?= I18N::translate('no blood relationship') ?>
                                    <?php endif ?>
                                </span>
                            <?php endif ?>
                        <?php endif ?>
                        <?php if ($filterObj->efp->$propName->allCount): ?>
                            <div class="hh-extended-family-summary">
                                <?php if ($propName == 'great_grandparents'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one great-grandmother recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one great-grandfather recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one great-grandparent of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d great-grandmother recorded.',  '%2$s has %1$d great-grandmothers recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d great-grandfather recorded.', '%2$s has %1$d great-grandfathers recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d great-grandparent of unknown sex recorded.', '%2$s has %1$d great-grandparents of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d great-grandfather and ', '%2$s has %1$d great-grandfathers and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d great-grandmother recorded (%d in total).', '%d great-grandmothers recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d great-grandfather and ', '%2$s has %1$d great-grandfathers and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d great-grandparent of unknown sex recorded (%d in total).', '%d great-grandparents of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d great-grandmother and ', '%2$s has %1$d great-grandmothers and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d great-grandparent of unknown sex recorded (%d in total).', '%d great-grandparents of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d great-grandfather, ', '%2$s has %1$d great-grandfathers, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d great-grandmother, and ', '%d great-grandmothers, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d great-grandparent of unknown sex recorded (%d in total).', '%d great-grandparents of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'grandparents'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one grandmother recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one grandfather recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one grandparent of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandmother recorded.',  '%2$s has %1$d grandmothers recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandfather recorded.', '%2$s has %1$d grandfathers recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandparent of unknown sex recorded.', '%2$s has %1$d grandparents of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandfather and ', '%2$s has %1$d grandfathers and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d grandmother recorded (%d in total).', '%d grandmothers recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandfather and ', '%2$s has %1$d grandfathers and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d grandparent of unknown sex recorded (%d in total).', '%d grandparents of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandmother and ', '%2$s has %1$d grandmothers and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d grandparent of unknown sex recorded (%d in total).', '%d grandparents of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandfather, ', '%2$s has %1$d grandfathers, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d grandmother, and ', '%d grandmothers, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d grandparent of unknown sex recorded (%d in total).', '%d grandparents of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'uncles_and_aunts'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one aunt recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one uncle recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one uncle or aunt of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d aunt recorded.',  '%2$s has %1$d aunts recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d uncle recorded.', '%2$s has %1$d uncles recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d uncle or aunt of unknown sex recorded.', '%2$s has %1$d uncles or aunts of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d uncle and ', '%2$s has %1$d uncles and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d aunt recorded (%d in total).', '%d aunts recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d uncle and ', '%2$s has %1$d uncles and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d uncle or aunt of unknown sex recorded (%d in total).', '%d uncles or aunts of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d aunt and ', '%2$s has %1$d aunts and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d uncle or aunt of unknown sex recorded (%d in total).', '%d uncles or aunts of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d uncle, ', '%2$s has %1$d uncles, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d aunt, and ', '%d aunts, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d uncle or aunt of unknown sex recorded (%d in total).', '%d uncles or aunts of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'uncles_and_aunts_bm'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one aunt by marriage recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one uncle by marriage recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one uncle or aunt by marriage of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d aunt by marriage recorded.',  '%2$s has %1$d aunts by marriage recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d uncle by marriage recorded.', '%2$s has %1$d uncles by marriage recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d uncle or aunt by marriage of unknown sex recorded.', '%2$s has %1$d uncles or aunts by marriage of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d uncle by marriage and ', '%2$s has %1$d uncles by marriage and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d aunt by marriage recorded (%d in total).', '%d aunts by marriage recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d uncle by marriage and ', '%2$s has %1$d uncles by marriage and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d uncle or aunt by marriage of unknown sex recorded (%d in total).', '%d uncles or aunts by marriage of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d aunt by marriage and ', '%2$s has %1$d aunts by marriage and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d uncle or aunt by marriage of unknown sex recorded (%d in total).', '%d uncles or aunts by marriage of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d uncle by marriage, ', '%2$s has %1$d uncles by marriage, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d aunt by marriage, and ', '%d aunts by marriage, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d uncle or aunt by marriage of unknown sex recorded (%d in total).', '%d uncles or aunts by marriage of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'parents'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one mother recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one father recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one parent of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d mother recorded.',  '%2$s has %1$d mothers recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d father recorded.', '%2$s has %1$d fathers recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d parent of unknown sex recorded.', '%2$s has %1$d parents of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d father and ', '%2$s has %1$d fathers and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d mother recorded (%d in total).', '%d mothers recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d father and ', '%2$s has %1$d fathers and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d parent of unknown sex recorded (%d in total).', '%d parents of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d mother and ', '%2$s has %1$d mothers and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d parent of unknown sex recorded (%d in total).', '%d parents of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d father, ', '%2$s has %1$d fathers, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d mother, and ', '%d mothers, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d parent of unknown sex recorded (%d in total).', '%d parents of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                    <?php if ($extfam_obj->config->showLabels && $extfam_obj->proband->labels): ?>
                                        <?php foreach ($extfam_obj->proband->labels as $label): ?>
                                            <span class="hh_extended_family_label"><?= $label ?></span>&nbsp;
                                        <?php endforeach ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'parents_in_law'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one mother-in-law recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one father-in-law recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one parent-in-law of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d mother-in-law recorded.',  '%2$s has %1$d mothers-in-law recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d father-in-law recorded.', '%2$s has %1$d fathers-in-law recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d parent-in-law of unknown sex recorded.', '%2$s has %1$d parents-in-law of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d father-in-law and ', '%2$s has %1$d fathers-in-law and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d mother-in-law recorded (%d in total).', '%d mothers-in-law recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d father-in-law and ', '%2$s has %1$d fathers-in-law and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d parent-in-law of unknown sex recorded (%d in total).', '%d parents-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d mother-in-law and ', '%2$s has %1$d mothers-in-law and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d parent-in-law of unknown sex recorded (%d in total).', '%d parents-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d father-in-law, ', '%2$s has %1$d fathers-in-law, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d mother-in-law, and ', '%d mothers-in-law, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d parent-in-law of unknown sex recorded (%d in total).', '%d parents-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'co_parents_in_law'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one co-mother-in-law recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one co-father-in-law recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one co-parent-in-law of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-mother-in-law recorded.',  '%2$s has %1$d co-mothers-in-law recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-father-in-law recorded.', '%2$s has %1$d co-fathers-in-law recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-parent-in-law of unknown sex recorded.', '%2$s has %1$d co-parents-in-law of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-father-in-law and ', '%2$s has %1$d co-fathers-in-law and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d co-mother-in-law recorded (%d in total).', '%d co-mothers-in-law recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-father-in-law and ', '%2$s has %1$d co-fathers-in-law and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d co-parent-in-law of unknown sex recorded (%d in total).', '%d co-parents-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-mother-in-law and ', '%2$s has %1$d co-mothers-in-law and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d co-parent-in-law of unknown sex recorded (%d in total).', '%d co-parents-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-father-in-law, ', '%2$s has %1$d co-fathers-in-law, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d co-mother-in-law, and ', '%d co-mothers-in-law, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d co-parent-in-law of unknown sex recorded (%d in total).', '%d co-parents-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'partners'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one female partner recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one male partner recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one partner of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->popCount == 0): ?>
                                            <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                                <h3><?= I18N::plural('%2$s has %1$d female partner recorded.',  '%2$s has %1$d female partners recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                            <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                                <h3><?= I18N::plural('%2$s has %1$d male partner recorded.', '%2$s has %1$d male partners recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                            <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                                <h3><?= I18N::plural('%2$s has %1$d partner of unknown sex recorded.', '%2$s has %1$d partners of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                            <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                                <h3><?= I18N::plural('%2$s has %1$d male partner and ', '%2$s has %1$d male partners and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                    <?= I18N::plural('%d female partner recorded (%d in total).', '%d female partners recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                            <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                                <h3><?= I18N::plural('%2$s has %1$d male partner and ', '%2$s has %1$d male partners and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                    <?= I18N::plural('%d partner of unknown sex recorded (%d in total).', '%d partners of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                            <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                                <h3><?= I18N::plural('%2$s has %1$d female partner and ', '%2$s has %1$d female partners and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                    <?= I18N::plural('%d partner of unknown sex recorded (%d in total).', '%d partners of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                            <?php else: ?>
                                                <h3><?= I18N::plural('%2$s has %1$d male partner, ', '%2$s has %1$d male partners, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                    <?= I18N::plural('%d female partner, and ', '%d female partners, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                    <?= I18N::plural('%d partner of unknown sex recorded (%d in total).', '%d partners of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                            <?php endif ?>
                                        <?php else: ?>
                                            <?php if ($extfam_obj->proband->indi->sex() == 'M'): ?>
                                                <h3><?= I18N::plural('%2$s has %1$d female partner and ', '%2$s has %1$d female partners and ', $filterObj->efp->$propName->pfemaleCount, $filterObj->efp->$propName->pfemaleCount, $extfam_obj->proband->niceName) ?>
                                                    <?= I18N::plural('%d male partner of female partners recorded (%d in total).', '%d male partners of female partners recorded (%d in total).', $filterObj->efp->$propName->popmaleCount, $filterObj->efp->$propName->popmaleCount, $filterObj->efp->$propName->allCount) ?>
                                                </h3>
                                            <?php elseif ($extfam_obj->proband->indi->sex() == 'F'): ?>
                                                <h3><?= I18N::plural('%2$s has %1$d male partner and ', '%2$s has %1$d male partners and ', $filterObj->efp->$propName->pmaleCount, $filterObj->efp->$propName->pmaleCount, $extfam_obj->proband->niceName) ?>
                                                    <?= I18N::plural('%d female partner of male partners recorded (%d in total).', '%d female partners of male partners recorded (%d in total).', $filterObj->efp->$propName->popfemaleCount, $filterObj->efp->$propName->popfemaleCount, $filterObj->efp->$propName->allCount) ?>
                                                </h3>
                                            <?php endif ?>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'partner_chains'): ?>
                                    <?php if ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                        <h3><?= I18N::plural('%2$s has %1$d male partner and ', '%2$s has %1$d male partners and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                            <?= I18N::plural('%d female partner in this partner chain recorded (%d in total).', '%d female partners in this partner chain recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?>
                                        </h3>
                                    <?php else: ?>
                                        <h3><?= I18N::plural('%2$s has %1$d male partner and ', '%2$s has %1$d male partners and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                            <?= I18N::plural('%d female partner and ', '%d female partners and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                            <?= I18N::plural('%d partner of unknown sex in this partner chain recorded (%d in total).', '%d partners of unknown sex in this partner chain recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?>
                                        </h3>
                                    <?php endif ?>
                                    <?php if ($filterObj->efp->$propName->chainsCount > 1): ?>
                                        <h3><?= I18N::translate('There are %d branches in the partner chain. ', $filterObj->efp->$propName->chainsCount, $filterObj->efp->$propName->chainsCount) ?>
                                            <?php if ($filterOption == 'all'): ?>
                                                <?= I18N::translate('The longest branch in the partner chain to %2$s consists of %1$d partners (including %3$s).', $filterObj->efp->$propName->longestChainCount, $filterObj->efp->$propName->mostDistantPartner->fullname(), $extfam_obj->proband->niceName) ?>
                                            <?php else: ?>
                                                <?= I18N::translate('The longest branch in the partner chain consists of %1$d partners (including %2$s).', $filterObj->efp->$propName->longestChainCount, $extfam_obj->proband->niceName) ?>
                                            <?php endif ?>
                                        </h3>
                                    <?php endif ?>
                                <?php elseif ($propName == 'siblings'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one sister recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one brother recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one sibling of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d sister recorded.',  '%2$s has %1$d sisters recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d brother recorded.', '%2$s has %1$d brothers recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d sibling of unknown sex recorded.', '%2$s has %1$d siblings of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d brother and ', '%2$s has %1$d brothers and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d sister recorded (%d in total).', '%d sisters recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d brother and ', '%2$s has %1$d brothers and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d sibling of unknown sex recorded (%d in total).', '%d siblings of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d sister and ', '%2$s has %1$d sisters and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d sibling of unknown sex recorded (%d in total).', '%d siblings of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d brother, ', '%2$s has %1$d brothers, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d sister, and ', '%d sisters, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d sibling of unknown sex recorded (%d in total).', '%d siblings of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                    <?php if ($extfam_obj->config->showLabels && $extfam_obj->proband->labels): ?>
                                        <?php foreach ($extfam_obj->proband->labels as $label): ?>
                                            <span class="hh_extended_family_label"><?= $label ?></span>&nbsp;
                                        <?php endforeach ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'siblings_in_law'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one sister-in-law recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one brother-in-law recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one sibling-in-law of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d sister-in-law recorded.',  '%2$s has %1$d sisters-in-law recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d brother-in-law recorded.', '%2$s has %1$d brothers-in-law recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d sibling-in-law of unknown sex recorded.', '%2$s has %1$d siblings-in-law of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d brother-in-law and ', '%2$s has %1$d brothers-in-law and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d sister-in-law recorded (%d in total).', '%d sisters-in-law recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d brother-in-law and ', '%2$s has %1$d brothers-in-law and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d sibling-in-law of unknown sex recorded (%d in total).', '%d siblings-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d sister-in-law and ', '%2$s has %1$d sisters-in-law and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d sibling-in-law of unknown sex recorded (%d in total).', '%d siblings-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d brother-in-law, ', '%2$s has %1$d brothers-in-law, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d sister-in-law, and ', '%d sisters-in-law, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d sibling-in-law of unknown sex recorded (%d in total).', '%d siblings-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                    <?php if ($extfam_obj->config->showLabels && $extfam_obj->proband->labels): ?>
                                        <?php foreach ($extfam_obj->proband->labels as $label): ?>
                                            <span class="hh_extended_family_label"><?= $label ?></span>&nbsp;
                                        <?php endforeach ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'co_siblings_in_law'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one co-sister-in-law recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one co-brother-in-law recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one co-sibling-in-law of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-sister-in-law recorded.',  '%2$s has %1$d co-sisters-in-law recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-brother-in-law recorded.', '%2$s has %1$d co-brothers-in-law recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-sibling-in-law of unknown sex recorded.', '%2$s has %1$d co-siblings-in-law of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-brother-in-law and ', '%2$s has %1$d co-brothers-in-law and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d co-sister-in-law recorded (%d in total).', '%d co-sisters-in-law recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-brother-in-law and ', '%2$s has %1$d co-brothers-in-law and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d co-sibling-in-law of unknown sex recorded (%d in total).', '%d co-siblings-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-sister-in-law and ', '%2$s has %1$d co-sisters-in-law and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d co-sibling-in-law of unknown sex recorded (%d in total).', '%d co-siblings-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d co-brother-in-law, ', '%2$s has %1$d co-brothers-in-law, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d co-sister-in-law, and ', '%d co-sisters-in-law, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d co-sibling-in-law of unknown sex recorded (%d in total).', '%d co-siblings-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                    <?php if ($extfam_obj->config->showLabels && $extfam_obj->proband->labels): ?>
                                        <?php foreach ($extfam_obj->proband->labels as $label): ?>
                                            <span class="hh_extended_family_label"><?= $label ?></span>&nbsp;
                                        <?php endforeach ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'cousins'): ?>								
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one female first cousin recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one male first cousin recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one first cousin of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d female first cousin recorded.',  '%2$s has %1$d female first cousins recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d male first cousin recorded.', '%2$s has %1$d male first cousins recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d first cousin of unknown sex recorded.', '%2$s has %1$d first cousins of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d male first cousin and ', '%2$s has %1$d male first cousins and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d female first cousin recorded (%d in total).', '%d female first cousins recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d male first cousin and ', '%2$s has %1$d male first cousins and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d first cousin of unknown sex recorded (%d in total).', '%d first cousins of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d female first cousin and ', '%2$s has %1$d female first cousins and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d first cousin of unknown sex recorded (%d in total).', '%d first cousins of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d male first cousin, ', '%2$s has %1$d male first cousins, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d female first cousin, and ', '%d female first cousins, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d first cousin of unknown sex recorded (%d in total).', '%d first cousins of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'nephews_and_nieces'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one niece recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one nephew recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one nephew or niece of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d niece recorded.',  '%2$s has %1$d nieces recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d nephew recorded.', '%2$s has %1$d nephews recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d nephew or niece of unknown sex recorded.', '%2$s has %1$d nephews or nieces of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d nephew and ', '%2$s has %1$d nephews and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d niece recorded (%d in total).', '%d nieces recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d nephew and ', '%2$s has %1$d nephews and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d nephew or niece of unknown sex recorded (%d in total).', '%d nephews or nieces of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d niece and ', '%2$s has %1$d nieces and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d nephew or niece of unknown sex recorded (%d in total).', '%d nephews or nieces of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d nephew, ', '%2$s has %1$d nephews, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d niece, and ', '%d nieces, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d nephew or niece of unknown sex recorded (%d in total).', '%d nephews or nieces of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'children'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one daughter recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one son recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one child of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d daughter recorded.',  '%2$s has %1$d daughters recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d son recorded.', '%2$s has %1$d sons recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d child of unknown sex recorded.', '%2$s has %1$d children of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d son and ', '%2$s has %1$d sons and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d daughter recorded (%d in total).', '%d daughters recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d son and ', '%2$s has %1$d sons and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d child of unknown sex recorded (%d in total).', '%d children of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d daughter and ', '%2$s has %1$d daughters and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d child of unknown sex recorded (%d in total).', '%d children of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d son, ', '%2$s has %1$d sons, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d daughter, and ', '%d daughters, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d child of unknown sex recorded (%d in total).', '%d children of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'children_in_law'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one daughter-in-law recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one son-in-law recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one child-in-law of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d daughter-in-law recorded.',  '%2$s has %1$d daughters-in-law recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d son-in-law recorded.', '%2$s has %1$d sons-in-law recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d child-in-law of unknown sex recorded.', '%2$s has %1$d children-in-law of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d son-in-law and ', '%2$s has %1$d sons-in-law and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d daughter-in-law recorded (%d in total).', '%d daughters-in-law recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d son-in-law and ', '%2$s has %1$d sons-in-law and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d child-in-law of unknown sex recorded (%d in total).', '%d children-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d daughter-in-law and ', '%2$s has %1$d daughters-in-law and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d child-in-law of unknown sex recorded (%d in total).', '%d children-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d son-in-law, ', '%2$s has %1$d sons-in-law, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d daughter-in-law, and ', '%d daughters-in-law, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d child-in-law of unknown sex recorded (%d in total).', '%d children-in-law of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php elseif ($propName == 'grandchildren'): ?>
                                    <?php if ($filterObj->efp->$propName->allCount == 1): ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one granddaughter recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 1): ?>
                                            <h3><?= I18N::translate('%s has one grandson recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::translate('%s has one grandchild of unknown sex recorded.', $extfam_obj->proband->niceName) ?></h3>
                                        <?php endif ?>
                                    <?php else: ?>
                                        <?php if ($filterObj->efp->$propName->femaleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d granddaughter recorded.',  '%2$s has %1$d granddaughters recorded.', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandson recorded.', '%2$s has %1$d grandsons recorded.', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == $filterObj->efp->$propName->allCount): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandchild of unknown sex recorded.', '%2$s has %1$d grandchildren of unknown sex recorded.', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $extfam_obj->proband->niceName) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->otherSexCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandson and ', '%2$s has %1$d grandsons and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d granddaughter recorded (%d in total).', '%d granddaughters recorded (%d in total).', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->femaleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandson and ', '%2$s has %1$d grandsons and ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d grandchild of unknown sex recorded (%d in total).', '%d grandchildren of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php elseif ($filterObj->efp->$propName->maleCount == 0): ?>
                                            <h3><?= I18N::plural('%2$s has %1$d granddaughter and ', '%2$s has %1$d granddaughters and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d grandchild of unknown sex recorded (%d in total).', '%d grandchildren of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php else: ?>
                                            <h3><?= I18N::plural('%2$s has %1$d grandson, ', '%2$s has %1$d grandsons, ', $filterObj->efp->$propName->maleCount, $filterObj->efp->$propName->maleCount, $extfam_obj->proband->niceName) ?>
                                                <?= I18N::plural('%d granddaughter, and ', '%d granddaughters, and ', $filterObj->efp->$propName->femaleCount, $filterObj->efp->$propName->femaleCount) ?>
                                                <?= I18N::plural('%d grandchild of unknown sex recorded (%d in total).', '%d grandchildren of unknown sex recorded (%d in total).', $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->otherSexCount, $filterObj->efp->$propName->allCount) ?></h3>
                                        <?php endif ?>
                                    <?php endif ?>
                                <?php endif ?>
                            </div>
                            <?php if ($extfam_obj->config->useCompactDesign): ?>
                            <div id="hh_extended_family_content_compact">
                            <?php else: ?>
                            <div id="hh_extended_family_content">
                            <?php endif ?>
                                <?php if ($propName == 'partners'): ?>
                                    <?php foreach ($filterObj->efp->$propName->groups as $key => $group): ?>
                                        <div id="hh_extended_family_box">
                                            <h4><?= I18N::translate('Partner of ') ?>
                                                <?php if ($group->partner->xref() == $extfam_obj->proband->indi->xref()): ?>
                                                    <?= $extfam_obj->proband->niceName ?>
                                                <?php else: ?>
                                                    <?php if ($group->partner->canShow()): ?>
                                                        <span class="hh_extended_family_name"><a href="<?= e($group->partner->url()) ?>"><?= $group->partner->fullName() ?></a></span>
                                                    <?php else: ?>
                                                        <span class="hh_extended_family_name"><?= $group->partner->fullName() ?></span>
                                                    <?php endif ?>
                                                <?php endif ?>
                                                &nbsp;(<?= count($group->members) ?>)
                                            </h4>
                                            <?php $i = 1; ?>
                                            <?php foreach ($group->members as $indi) : ?>
                                                <div class="wt-chart-box-<?= strtolower($indi->sex()) ?>">
                                                    <?php if ($indi->canShow()): ?>
                                                        <?php if ($extfam_obj->config->showThumbnail): ?>
                                                            <div class="wt-chart-box-thumbnail float-left mr-1"><?= $indi->displayImage($extfam_obj->config->sizeThumbnailW, $extfam_obj->config->sizeThumbnailH, 'crop', ['class' => 'wt-chart-box-thumbnail']) ?></div>
                                                        <?php endif ?>
                                                        <span class="hh_extended_family_counter"><?= $i ?></span>
                                                        <span class="hh_extended_family_name"><a href="<?= e($indi->url()) ?>"><?= $indi->fullName() ?></a></span>
                                                        <?php if ($extfam_obj->config->useCompactDesign): ?>
                                                            <span class="hh_extended_family_lifespan" ><?= $indi->lifespan() ?></span>
                                                        <?php else: ?>
                                                            <span class="hh_extended_family_birth_death">
                                                                <?php $event = $indi->facts(['BIRT'])->first(); ?>
                                                                <?php if ($event instanceof Fact): ?>
                                                                    <?= $event->summary(); ?>
                                                                <?php endif ?>
                                                                <?php $event = $indi->facts(['DEAT'])->first(); ?>
                                                                <?php if ($event instanceof Fact): ?>
                                                                    <?= $event->summary(); ?>
                                                                <?php endif ?>
                                                            </span>
                                                        <?php endif ?>
                                                    <?php else: ?>
                                                        <span class="hh_extended_family_name"><?= $indi->fullName() ?></span>
                                                    <?php endif ?>
                                                </div>
                                            <?php $i++; endforeach ?>
                                        </div>    
                                    <?php endforeach ?>
                                <?php elseif ($propName == 'partner_chains'): ?>
                                    <div id="hh_extended_family_box">
                                        <?php $i = 1; ?>
                                        <?php foreach ($filterObj->efp->$propName->displayChains as $chain) : ?>
                                            <?php if ($i > 1): ?>
                                                <hr>
                                            <?php endif ?>
                                            <?php $j = 1; ?>                                                
                                            <?php foreach ($chain as $indi) : ?>
                                                <?php if ($j > 1): ?>
                                                    <?php echo ' ∞ ' ?>
                                                <?php endif ?>
                                                <?php if ($indi->canShow): ?>
                                                    <span class="hh_extended_family_counter"><?= $indi->step ?></span>
                                                    <span class="hh_extended_family_name"><a href="<?= e($indi->url) ?>"><?= $indi->fullName ?></a></span>
                                                <?php else: ?>
                                                    <span class="hh_extended_family_counter"><?= $indi->step ?></span>
                                                    <span class="hh_extended_family_name"><?= $indi->fullName ?></span>
                                                <?php endif ?>
                                            <?php $j++; endforeach ?>
                                        <?php $i++; endforeach ?>
                                    </div>
                                <?php elseif ($propName == 'parents_in_law'): ?>
                                    <?php foreach ($filterObj->efp->$propName->groups as $group): ?>
                                        <div id="hh_extended_family_box">
                                            <h4>
                                                <?php if ($group->partner->canShow()): ?>
                                                    <span class="hh_extended_family_name"><?= I18N::translate($group->partnerFamilyStatus) ?><?= I18N::translate(' with ') ?><a href="<?= e($group->partner->url()) ?>"><?= $group->partner->fullName() ?></a></span>
                                                <?php else: ?>
                                                    <span class="hh_extended_family_name"><?= I18N::translate('Partnership') . I18N::translate(' with ') . $group->partner->fullName() ?></span>
                                                <?php endif ?>
                                                &nbsp;(<?= count($group->members) ?>)
                                            </h4>
                                            <?php $prev_fam_id = '-1'; ?>
                                            <?php if ($group->family->xref() != $prev_fam_id) : ?>
                                                <?php $prev_fam_id = $group->family->xref(); $i = 1; ?>
                                                <?php if ($group->family->canShow()): ?>
                                                    <h5><?= I18N::translate($group->familyStatus) ?>&nbsp;<a href="<?= e($group->family->url()); ?>"><?= $group->family->fullName() ?></a></h5>
                                                <?php else: ?>
                                                    <h5><?= I18N::translate('Partnership') ?>&nbsp;<?= $group->family->fullName() ?></h5>
                                                <?php endif ?>
                                            <?php endif ?>
                                            <?php foreach ($group->members as $indi) : ?>
                                                <div class="wt-chart-box-<?= strtolower($indi->sex()) ?>">
                                                    <?php if ($indi->canShow()): ?>
                                                        <?php if ($extfam_obj->config->showThumbnail): ?>
                                                            <div class="wt-chart-box-thumbnail float-left mr-1"><?= $indi->displayImage($extfam_obj->config->sizeThumbnailW, $extfam_obj->config->sizeThumbnailH, 'crop', ['class' => 'wt-chart-box-thumbnail']) ?></div>
                                                        <?php endif ?>
                                                        <span class="hh_extended_family_counter"><?= $i ?></span>
                                                        <span class="hh_extended_family_name"><a href="<?= e($indi->url()) ?>"><?= $indi->fullName() ?></a></span>
                                                        <?php if ($extfam_obj->config->useCompactDesign): ?>
                                                            <span class="hh_extended_family_lifespan" ><?= $indi->lifespan() ?></span>
                                                        <?php else: ?>
                                                            <span class="hh_extended_family_birth_death">
                                                                <?php $event = $indi->facts(['BIRT'])->first(); ?>
                                                                <?php if ($event instanceof Fact): ?>
                                                                    <?= $event->summary(); ?>
                                                                <?php endif ?>
                                                                <?php $event = $indi->facts(['DEAT'])->first(); ?>
                                                                <?php if ($event instanceof Fact): ?>
                                                                    <?= $event->summary(); ?>
                                                                <?php endif ?>
                                                            </span>
                                                        <?php endif ?>
                                                    <?php else: ?>
                                                        <span class="hh_extended_family_name"><?= $indi->fullName() ?></span>
                                                    <?php endif ?>
                                                </div>
                                            <?php $i++; endforeach ?>
                                        </div>    
                                    <?php endforeach ?>
                                <?php else: ?>
                                    <?php foreach ($filterObj->efp->$propName->groups as $group): ?>
                                        <div id="hh_extended_family_box">
                                            <h4><?= I18N::translate($group->groupName); ?>&nbsp;(<?= count($group->members) ?>)</h4>
                                            <?php $prev_id = -1; $prev_id1 = -1; $prev_id2 = -1; ?>
                                            <?php  foreach ($group->members as $key => $indi) : ?>
                                                <?php if ($propName == 'siblings_in_law' || $propName == 'uncles_and_aunts_bm') : ?>
                                                    <?php if ($group->referencePersons[$key][1]->xref() != $prev_id): ?>
                                                        <?php $prev_id = $group->referencePersons[$key][1]->xref(); $i = 1; ?>
                                                        <?php if ($group->referencePersons[$key][1]->canShow()): ?>
                                                            <?php if ($group->groupName == 'Partners of siblings' || $group->groupName == 'Siblings of siblings-in-law' || $group->groupName == 'Siblings-in-law of father' || $group->groupName == 'Siblings-in-law of mother' || $group->groupName == 'Children of siblings' || $group->groupName == 'Siblings\' stepchildren'): ?>
                                                                <?php if ($group->referencePersons[$key][1]->sex() == 'M'): ?>
                                                                    <h5><?= I18N::translate('Brother') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php elseif ($group->referencePersons[$key][1]->sex() == 'F'): ?>
                                                                    <h5><?= I18N::translate('Sister') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php else: ?>
                                                                    <h5><?= I18N::translate('Sibling') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php endif ?>
                                                            <?php elseif ($group->groupName == 'Children of siblings of partners'): ?>
                                                                <?php $linkReferencePerson = ('<a href="'.e($group->referencePersons[$key][1]->url()).'">'.$group->referencePersons[$key][1]->fullName().'</a>') ?>
                                                                <?php if ($group->referencePersons[$key][2]->canShow()): ?>
                                                                    <?php $linkReferencePerson2 = ('<a href="'.e($group->referencePersons[$key][2]->url()).'">'.$group->referencePersons[$key][2]->fullName().'</a>') ?>
                                                                <?php else: ?>
                                                                    <?php $linkReferencePerson2 = $group->referencePersons[$key][2]->fullName() ?>
                                                                <?php endif ?>
                                                                <?php if ($group->referencePersons[$key][2]->sex() == 'M'): ?>
                                                                    <h5><?= I18N::translate('Brother %1$s of partner %2$s', $linkReferencePerson2, $linkReferencePerson) ?></h5>
                                                                <?php elseif ($group->referencePersons[$key][2]->sex() == 'F'): ?>
                                                                    <h5><?= I18N::translate('Sister %1$s of partner %2$s', $linkReferencePerson2, $linkReferencePerson) ?></h5>
                                                                <?php else: ?>
                                                                    <h5><?= I18N::translate('Sibling %1$s of partner %2$s', $linkReferencePerson2, $linkReferencePerson) ?></h5>
                                                                <?php endif ?>
                                                            <?php elseif ($group->groupName == 'Siblings of partners' || $group->groupName == 'Partners of siblings-in-law'): ?>
                                                                <h5><?= I18N::translate($group->familiesStatus[$key]) ?><?= I18N::translate(' with ') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                            <?php endif ?>
                                                        <?php else: ?>
                                                            <?php if ($group->groupName == 'Partners of siblings'  || $group->groupName == 'Siblings of siblings-in-law' || $group->groupName == 'Siblings-in-law of father' || $group->groupName == 'Siblings-in-law of mother') : ?>
                                                                <h5><?= I18N::translate('Sibling')?>&nbsp;<?= $group->referencePersons[$key][1]->fullName() ?></h5>
                                                            <?php elseif ($group->groupName == 'Siblings of partners' || $group->groupName == 'Partners of siblings-in-law'): ?>
                                                                <h5><?= I18N::translate('Partner')?>&nbsp;<?= $group->referencePersons[$key][1]->fullName() ?></h5>
                                                            <?php endif ?>
                                                        <?php endif ?>
                                                    <?php endif ?>
                                                <?php elseif ($propName == 'nephews_and_nieces') : ?>
                                                    <?php if ($group->referencePersons[$key][1]->xref() != $prev_id1 || (isset($group->referencePersons[$key][2]) && ($group->referencePersons[$key][2]->xref() != $prev_id2))): ?>
                                                        <?php $prev_id1 = $group->referencePersons[$key][1]->xref(); $i = 1; ?>
                                                        <?php if ($group->referencePersons[$key][1]->canShow()): ?>
                                                            <?php if ($group->groupName == Nephews_and_nieces::GROUP_NEPHEW_NIECES_CHILD_SIBLING || $group->groupName == Nephews_and_nieces::GROUP_NEPHEW_NIECES_CHILD_PARTNER_SIBLING): ?>
                                                                <?php if ($group->referencePersons[$key][1]->sex() == 'M'): ?>
                                                                    <h5><?= I18N::translate('Brother') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php elseif ($group->referencePersons[$key][1]->sex() == 'F'): ?>
                                                                    <h5><?= I18N::translate('Sister') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php else: ?>
                                                                    <h5><?= I18N::translate('Sibling') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php endif ?>
                                                            <?php elseif ($group->groupName == Nephews_and_nieces::GROUP_NEPHEW_NIECES_CHILD_SIBLING_PARTNER): ?>
                                                                <?php $prev_id2 = $group->referencePersons[$key][2]->xref(); ?>
                                                                <?php $linkReferencePerson = ('<a href="'.e($group->referencePersons[$key][1]->url()).'">'.$group->referencePersons[$key][1]->fullName().'</a>') ?>
                                                                <?php if ($group->referencePersons[$key][2]->canShow()): ?>
                                                                    <?php $linkReferencePerson2 = ('<a href="'.e($group->referencePersons[$key][2]->url()).'">'.$group->referencePersons[$key][2]->fullName().'</a>') ?>
                                                                <?php else: ?>
                                                                    <?php $linkReferencePerson2 = $group->referencePersons[$key][2]->fullName() ?>
                                                                <?php endif ?>
                                                                <?php if ($group->referencePersons[$key][2]->sex() == 'M'): ?>
                                                                    <h5><?= I18N::translate('Brother %1$s of partner %2$s', $linkReferencePerson2, $linkReferencePerson) ?></h5>
                                                                <?php elseif ($group->referencePersons[$key][2]->sex() == 'F'): ?>
                                                                    <h5><?= I18N::translate('Sister %1$s of partner %2$s', $linkReferencePerson2, $linkReferencePerson) ?></h5>
                                                                <?php else: ?>
                                                                    <h5><?= I18N::translate('Sibling %1$s of partner %2$s', $linkReferencePerson2, $linkReferencePerson) ?></h5>
                                                                <?php endif ?>
                                                            <?php endif ?>
                                                        <?php else: ?>
                                                            <?php if ($group->groupName == Nephews_and_nieces::GROUP_NEPHEW_NIECES_CHILD_SIBLING || $group->groupName == Nephews_and_nieces::GROUP_NEPHEW_NIECES_CHILD_PARTNER_SIBLING): ?>
                                                                <h5><?= I18N::translate('Sibling')?>&nbsp;<?= $group->referencePersons[$key][1]->fullName() ?></h5>
                                                            <?php elseif ($group->groupName == Nephews_and_nieces::GROUP_NEPHEW_NIECES_CHILD_SIBLING_PARTNER): ?>
                                                                <?php if ($group->referencePersons[$key][2]->canShow()): ?>
                                                                    <?php $linkReferencePerson2 = ('<a href="'.e($group->referencePersons[$key][2]->url()).'">'.$group->referencePersons[$key][2]->fullName().'</a>') ?>
                                                                <?php else: ?>
                                                                    <?php $linkReferencePerson2 = $group->referencePersons[$key][2]->fullName() ?>
                                                                <?php endif ?>
                                                                <h5><?= I18N::translate('Sibling %1$s of partner %2$s', $linkReferencePerson2, $group->referencePersons[$key][1]->fullName()) ?></h5>
                                                            <?php endif ?>
                                                        <?php endif ?>
                                                    <?php endif ?>
                                                <?php elseif ($propName == 'children_in_law'): ?>
                                                    <?php if ($group->referencePersons[$key][1]->xref() != $prev_id): ?>
                                                        <?php $prev_id = $group->referencePersons[$key][1]->xref(); $i = 1; ?>
                                                        <?php if ($group->referencePersons[$key][1]->canShow()): ?>
                                                            <?php if ($group->groupName == 'Partners of biological children'): ?>
                                                                <?php if ($group->referencePersons[$key][1]->sex() == 'M'): ?>
                                                                    <h5><?= I18N::translate('Son') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php elseif ($group->referencePersons[$key][1]->sex() == 'F'): ?>
                                                                    <h5><?= I18N::translate('Daughter') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php else: ?>
                                                                    <h5><?= I18N::translate('Child') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php endif ?>
                                                            <?php elseif ($group->groupName == 'Partners of stepchildren'): ?>
                                                                <?php if ($group->referencePersons[$key][1]->sex() == 'M'): ?>
                                                                    <h5><?= I18N::translate('Stepson') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php elseif ($group->referencePersons[$key][1]->sex() == 'F'): ?>
                                                                    <h5><?= I18N::translate('Stepdaughter') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php else: ?>
                                                                    <h5><?= I18N::translate('Stepchild') ?><a href="<?= e($group->referencePersons[$key][1]->url()); ?>">&nbsp;<?= $group->referencePersons[$key][1]->fullName(); ?></a></h5>
                                                                <?php endif ?>
                                                            <?php endif ?>
                                                        <?php else: ?>
                                                            <?php if ($group->groupName == 'Partners of biological children'): ?>
                                                                <h5><?= I18N::translate('Child')?>&nbsp;<?= $group->referencePersons[$key][1]->fullName() ?></h5>
                                                            <?php elseif ($group->groupName == 'Partners of stepchildren'): ?>
                                                                <h5><?= I18N::translate('Stepchild')?>&nbsp;<?= $group->referencePersons[$key][1]->fullName() ?></h5>
                                                            <?php endif ?>
                                                        <?php endif ?>
                                                    <?php endif ?>
                                                <?php elseif ($propName == 'great_grandparents' || $propName == 'grandparents' || $propName == 'uncles_and_aunts' || $propName == 'parents' || $propName == 'co_parents_in_law'): ?>
                                                    <?php if ($group->families[$key]->xref() != $prev_id): ?>
                                                        <?php $prev_id = $group->families[$key]->xref(); $i = 1; ?>
                                                        <?php if ($group->families[$key]->canShow()): ?>
                                                            <?php if (str_starts_with($group->groupName, 'Biological grandparents of ') || $group->groupName == 'Parents of stepparents' || $group->groupName == 'Partners of siblings'): ?>
                                                                <?php $linkParents = ('<a href="'.e($group->families[$key]->url()).'">'.$group->families[$key]->fullName().'</a>') ?>
                                                                <?php $linkReferencePerson = ('<a href="'.e($group->referencePersons[$key][1]->url()).'">'.$group->referencePersons[$key][1]->fullName().'</a>') ?>
                                                                <h5><?= I18N::translate('Parents %1$s (%2$s) of %3$s', $linkParents, I18N::translate($group->familiesStatus[$key]), $linkReferencePerson) ?></h5>
                                                            <?php elseif (str_starts_with($group->groupName, 'Stepparents of biological')): ?>
                                                                <?php $linkParents = ('<a href="'.e($group->families[$key]->url()).'">'.$group->families[$key]->fullName().'</a>') ?>
                                                                <?php $linkReferencePerson = ('<a href="'.e($group->referencePersons[$key][1]->url()).'">'.$group->referencePersons[$key][1]->fullName().'</a>') ?>
                                                                <h5><?= I18N::translate('Stepparents %1$s (%2$s) of %3$s', $linkParents, I18N::translate($group->familiesStatus[$key]), $linkReferencePerson) ?></h5>
                                                            <?php elseif (str_starts_with($group->groupName, 'Parents of stepparent of')): ?>
                                                                <?php $linkParents = ('<a href="'.e($group->families[$key]->url()).'">'.$group->families[$key]->fullName().'</a>') ?>
                                                                <?php $linkReferencePerson = ('<a href="'.e($group->referencePersons[$key][1]->url()).'">'.$group->referencePersons[$key][1]->fullName().'</a>') ?>
                                                                <?php if ($group->referencePersons[$key][1]->sex() == 'M'): ?>
                                                                    <h5><?= I18N::translate('Parents %1$s (%2$s) of stepfather %3$s', $linkParents, I18N::translate($group->familiesStatus[$key]), $linkReferencePerson) ?></h5>
                                                                <?php elseif ($group->referencePersons[$key][1]->sex() == 'F'): ?>
                                                                    <h5><?= I18N::translate('Parents %1$s (%2$s) of stepmother %3$s', $linkParents, I18N::translate($group->familiesStatus[$key]), $linkReferencePerson) ?></h5>
                                                                <?php else: ?>
                                                                    <h5><?= I18N::translate('Parents %1$s (%2$s) of stepparent %3$s', $linkParents, I18N::translate($group->familiesStatus[$key]), $linkReferencePerson) ?></h5>
                                                                <?php endif ?>
                                                            <?php elseif ($group->groupName == 'Grandparents of stepparent'): ?>
                                                                <?php $linkParents = ('<a href="'.e($group->families[$key]->url()).'">'.$group->families[$key]->fullName().'</a>') ?>
                                                                <?php $linkReferencePerson = ('<a href="'.e($group->referencePersons[$key][1]->url()).'">'.$group->referencePersons[$key][1]->fullName().'</a>') ?>
                                                                <?php if ($group->referencePersons[$key][1]->sex() == 'M'): ?>
                                                                    <h5><?= I18N::translate('Grandparents %1$s (%2$s) of stepfather %3$s', $linkParents, I18N::translate($group->familiesStatus[$key]), $linkReferencePerson) ?></h5>
                                                                <?php elseif ($group->referencePersons[$key][1]->sex() == 'F'): ?>
                                                                    <h5><?= I18N::translate('Grandparents %1$s (%2$s) of stepmother %3$s', $linkParents, I18N::translate($group->familiesStatus[$key]), $linkReferencePerson) ?></h5>
                                                                <?php else: ?>
                                                                    <h5><?= I18N::translate('Grandparents %1$s (%2$s) of stepparent %3$s', $linkParents, I18N::translate($group->familiesStatus[$key]), $linkReferencePerson) ?></h5>
                                                                <?php endif ?>
                                                            <?php elseif ($group->groupName == 'Siblings of father' || $group->groupName == 'Siblings of mother'): ?>
                                                                <h5><?= I18N::translate('Parents')?>&nbsp;<a href="<?= e($group->families[$key]->url()); ?>">&nbsp;<?= $group->families[$key]->fullName() ?></a></h5>
                                                            <?php else: ?>
                                                                <h5><?= I18N::translate($group->familiesStatus[$key]) ?>&nbsp;<a href="<?= e($group->families[$key]->url()); ?>">&nbsp;<?= $group->families[$key]->fullName() ?></a></h5>
                                                            <?php endif ?>
                                                        <?php else: ?>
                                                            <?php if ($group->groupName == 'Parents of stepparents' || $group->groupName == 'Partners of siblings'): ?>
                                                                <h5><?= I18N::translate('Parents %1$s of %2$s', $group->families[$key]->fullName(), $group->referencePersons[$key][1]->fullName()) ?></h5>
                                                            <?php else: ?>
                                                                <h5><?= I18N::translate('Partnership') ?>&nbsp;<?= $group->families[$key]->fullName() ?></h5>
                                                            <?php endif ?>
                                                        <?php endif ?>
                                                    <?php endif ?>
                                                <?php elseif ($propName == 'co_siblings_in_law'): ?>
                                                    <?php if ($group->referencePersons[$key][1]->xref() != $prev_id): ?>
                                                        <?php $prev_id = $group->referencePersons[$key][1]->xref(); $i = 1; ?>
                                                        <?php if ($group->referencePersons[$key][1]->canShow()): ?>
                                                            <?php $linkReferencePerson = ('<a href="'.e($group->referencePersons[$key][1]->url()).'">'.$group->referencePersons[$key][1]->fullName().'</a>') ?>
                                                            <?php if ($group->groupName == 'Siblings of siblings-in-law'): ?>
                                                                <?php $linkParents = '<a href="'.e($group->families[$key]->url()).'">'.$group->families[$key]->fullName().'</a>' ?>
                                                                <?php $familyStatus = I18N::translate($group->familiesStatus[$key]) ?>
                                                                <h5><?= I18N::translate('Parents %1$s (%2$s) of %3$s', $linkParents, $familyStatus, $linkReferencePerson) ?></h5>
                                                            <?php else: ?>
                                                                <h5><?= I18N::translate('Partners of %s', $linkReferencePerson) ?></h5>
                                                            <?php endif ?>
                                                        <?php else: ?>
                                                            <?php if ($group->groupName == 'Siblings of siblings-in-law'): ?>
                                                                <h5><?= I18N::translate('Parents %1$s of %2$s', $group->families[$key]->fullName(), $group->referencePersons[$key][1]->fullName()) ?></h5>
                                                            <?php else: ?>
                                                                <h5><?= I18N::translate('Partners of %s', $group->referencePersons[$key][1]->fullName()) ?></h5>
                                                            <?php endif ?>
                                                        <?php endif ?>
                                                    <?php endif ?>
                                                <?php elseif ($propName == 'siblings' || $propName == 'cousins' || $propName == 'children' || $propName == 'grandchildren'): ?>
                                                    <?php if ($indi->childFamilies()->first()->xref() != $prev_id): ?>
                                                        <?php $prev_id = $indi->childFamilies()->first()->xref(); $i = 1; ?>
                                                        <?php if ($indi->childFamilies()->first()->canShow()): ?>
                                                            <h5><?= I18N::translate('Parents') ?><a href="<?= e($indi->childFamilies()->first()->url()); ?>">&nbsp;<?= $indi->childFamilies()->first()->fullName(); ?></a></h5>
                                                        <?php else: ?>
                                                            <h5><?= I18N::translate('Parents') ?>&nbsp;<?= $indi->childFamilies()->first()->fullName(); ?></h5>
                                                        <?php endif ?>   
                                                    <?php endif ?>
                                                <?php endif ?>
                                                <div class="wt-chart-box-<?= strtolower($indi->sex()) ?>">
                                                    <?php if ($indi->canShow()): ?>
                                                        <?php if ($extfam_obj->config->showThumbnail): ?>
                                                            <div class="wt-chart-box-thumbnail float-left mr-1"><?= $indi->displayImage($extfam_obj->config->sizeThumbnailW, $extfam_obj->config->sizeThumbnailH, 'crop', ['class' => 'wt-chart-box-thumbnail']) ?></div>
                                                        <?php endif ?>
                                                        <span class="hh_extended_family_counter"><?= $i ?></span>
                                                        <span class="hh_extended_family_name"><a href="<?= e($indi->url()) ?>"><?= $indi->fullName() ?></a></span>
                                                        <?php if ($extfam_obj->config->useCompactDesign): ?>
                                                            <span class="hh_extended_family_lifespan" ><?= $indi->lifespan() ?></span>
                                                        <?php else: ?>
                                                            <span class="hh_extended_family_birth_death">
                                                                <?php $event = $indi->facts(['BIRT'])->first(); ?>
                                                                <?php if ($event instanceof Fact): ?>
                                                                    <?= $event->summary(); ?>
                                                                <?php endif ?>
                                                                <?php $event = $indi->facts(['DEAT'])->first(); ?>
                                                                <?php if ($event instanceof Fact): ?>
                                                                    <?= $event->summary(); ?>
                                                                <?php endif ?>
                                                            </span>
                                                        <?php endif ?>
                                                        <?php if ($extfam_obj->config->showLabels && $group->labels[$key]): ?>
                                                            <?php foreach ($group->labels[$key] as $label): ?>
                                                                <span class="hh_extended_family_label_box"><?= $label ?></span>&nbsp;
                                                            <?php endforeach ?>
                                                        <?php endif ?>
                                                    <?php else: ?>
                                                        <span class="hh_extended_family_counter"><?= $i ?></span>
                                                        <span class="hh_extended_family_name"><?= $indi->fullName() ?></span>
                                                    <?php endif ?>
                                                </div>
                                            <?php $i++; endforeach ?>
                                        </div>
                                    <?php endforeach ?>
                                <?php endif ?>
                            <?php if ($extfam_obj->config->useCompactDesign): ?>
                            </div>
                            <?php else: ?>
                            </div>
                            <?php endif ?>
                        <?php else: ?>
                            <div class="hh-extended-family-summary">
                                <?php if ($extfam_obj->config->showEmptyBlock == 0): ?>
                                    <?php if ($propName == 'uncles_and_aunts'): ?>
                                        <h3><?= I18N::translate('%s has no uncles or aunts recorded.', $extfam_obj->proband->niceName) ?></h3>
                                    <?php elseif ($propName == 'uncles_and_aunts_bm'): ?>
                                        <h3><?= I18N::translate('%s has no uncles or aunts by marriage recorded.', $extfam_obj->proband->niceName) ?></h3>
                                    <?php elseif ($propName == 'partner_chains'): ?>
                                        <h3><?= I18N::translate('%s has no members of a partner chain recorded.', $extfam_obj->proband->niceName) ?></h3>
                                    <?php elseif ($propName == 'cousins'): ?>
                                        <h3><?= I18N::translate('%s has no first cousins recorded.', $extfam_obj->proband->niceName) ?></h3>
                                    <?php elseif ($propName == 'nephews_and_nieces'): ?>
                                        <h3><?= I18N::translate('%s has no nephews or nieces recorded.', $extfam_obj->proband->niceName) ?></h3>
                                    <?php else: ?>
                                        <h3><?= I18N::translate('%s has no ' . str_replace('_', '-', $propName) . ' recorded.', $extfam_obj->proband->niceName) ?></h3>
                                    <?php endif ?>
                                <?php endif ?>
                            </div>
                        <?php endif ?>
                    <?php endif ?>
                <?php endforeach ?>
                <?php if ($extfam_obj->config->showEmptyBlock == 1) : ?>
                    <?php if (count($filterObj->efp->summaryMessageEmptyBlocks) > 0) : ?>
                        <div class="hh-extended-family-summary">
                            <h2><?= I18N::translate('Parts of extended family without recorded information') ?></h2>
                            <?php $summaryListA = ExtendedFamilySupport::translateFamilyPart($filterObj->efp->summaryMessageEmptyBlocks[0]) ?>
                            <?php if (count($filterObj->efp->summaryMessageEmptyBlocks) == 1) : ?>
                                <h3><?= I18N::translate('%s has no %s recorded.', $extfam_obj->proband->niceName, $summaryListA) ?></h3>
                            <?php else: ?>
                                <?php for ($i = 1; $i <= count($filterObj->efp->summaryMessageEmptyBlocks)-2; $i++): ?>
                                    <?php $summaryListA .= ', ' . ExtendedFamilySupport::translateFamilyPart($filterObj->efp->summaryMessageEmptyBlocks[$i]) ?>
                                <?php endfor ?>
                                <?php $summaryListB = ExtendedFamilySupport::translateFamilyPart($filterObj->efp->summaryMessageEmptyBlocks[count($filterObj->efp->summaryMessageEmptyBlocks)-1]) ?>
                                <h3><?= I18N::translate('%s has no %s, and no %s recorded.', $extfam_obj->proband->niceName, $summaryListA, $summaryListB) ?></h3>
                            <?php endif ?>
                        </div>
                    <?php endif ?>
                <?php endif ?>
            <?php else: ?>
                <h3><?= I18N::translate('No family available') ?></h3>
            <?php endif ?>
        </div>
    <?php endforeach ?>
</div>

<?php View::push('javascript') ?>
<script>
  // stylesheet
  var newSheet = document.createElement("link");
  newSheet.setAttribute("rel","stylesheet");
  newSheet.setAttribute("type","text/css");
  newSheet.setAttribute("href","<?= $extended_family_css ?>");
  document.head.appendChild(newSheet);
  
  // filter: reset filter values
  sessionStorage.removeItem('sexFilterValue');
  sessionStorage.removeItem('aliveFilterValue');
  
  // filter: initial status: show only "all"
  $(".hh-extended-filter[data-filter-value='MY']").addClass('d-none');
  $(".hh-extended-filter[data-filter-value='FY']").addClass('d-none');
  $(".hh-extended-filter[data-filter-value='UY']").addClass('d-none');
  $(".hh-extended-filter[data-filter-value='MN']").addClass('d-none');
  $(".hh-extended-filter[data-filter-value='FN']").addClass('d-none');
  $(".hh-extended-filter[data-filter-value='UN']").addClass('d-none');
  $(".hh-extended-filter[data-filter-value='M']").addClass('d-none');
  $(".hh-extended-filter[data-filter-value='F']").addClass('d-none');
  $(".hh-extended-filter[data-filter-value='U']").addClass('d-none');
  $(".hh-extended-filter[data-filter-value='Y']").addClass('d-none');
  $(".hh-extended-filter[data-filter-value='N']").addClass('d-none');
  
  // filter click function
  $(".hh-extended-filter-button").click(function() {
      let checkbox = $(this);

      // deselect other options of this filter box
      let siblings = checkbox.parent().siblings();
      siblings.children().prop("checked", false).removeAttr("checked");
      siblings.removeClass('active');

      // apply and clear the filters
      let thisCheckbox = $(this);
      let thisFilterType = thisCheckbox.data("filter-type");
      
      if (sessionStorage.getItem('sexFilterValue') == null) {
        sessionStorage.setItem('sexFilterValue',"");
      }
      if (sessionStorage.getItem('aliveFilterValue') == null) {
        sessionStorage.setItem('aliveFilterValue',"");
      }

      if (thisCheckbox.prop("checked")) {
          if(thisFilterType == "sex") {
            sessionStorage.setItem('sexFilterValue',thisCheckbox.data("filter-value"));
          }    
          else {
            sessionStorage.setItem('aliveFilterValue',thisCheckbox.data("filter-value"));
          }
      }
      else {
          if(thisFilterType == "sex") {
            sessionStorage.setItem('sexFilterValue',"");
          }
          else {
            sessionStorage.setItem('aliveFilterValue',"");
          }
      }

      var filterValue = sessionStorage.getItem('sexFilterValue') + sessionStorage.getItem('aliveFilterValue');

      if(filterValue == "") {
          var filterValue = "all";
      }

      // make all blocks invisible
      $(".hh-extended-filter[data-filter-value='MY']").addClass('d-none');
      $(".hh-extended-filter[data-filter-value='FY']").addClass('d-none');
      $(".hh-extended-filter[data-filter-value='UY']").addClass('d-none');
      $(".hh-extended-filter[data-filter-value='MN']").addClass('d-none');
      $(".hh-extended-filter[data-filter-value='FN']").addClass('d-none');
      $(".hh-extended-filter[data-filter-value='UN']").addClass('d-none');
      $(".hh-extended-filter[data-filter-value='M']").addClass('d-none');
      $(".hh-extended-filter[data-filter-value='F']").addClass('d-none');
      $(".hh-extended-filter[data-filter-value='U']").addClass('d-none');
      $(".hh-extended-filter[data-filter-value='Y']").addClass('d-none');
      $(".hh-extended-filter[data-filter-value='N']").addClass('d-none');
      $(".hh-extended-filter[data-filter-value='all']").addClass('d-none');

      // make selected block visible
      $(".hh-extended-filter[data-filter-value='" + filterValue + "']").removeClass('d-none');

// console.log("hh-extended-filter[data-filter-value='"+filterValue+"']");
      
    })
</script>
<?php View::endpush() ?>
